
# What is Lambda authorizer? 

!!! tip "TLDR"
    A `Lambda authorizer` (formerly known as a custom authorizer) is an API Gateway feature that uses a Lambda function to control access to your API.

A Lambda authorizer is useful if you want to implement a custom authorization scheme that uses a bearer token authentication strategy such as OAuth or SAML, or that uses request parameters to determine the caller's identity.

When a client makes a request to one of your API's methods, API Gateway calls your Lambda authorizer, which takes the caller's identity as input and returns an IAM policy as output.

## Types of Lambda authorizers
!!! info 
    There are two types of Lambda authorizers:

    -   A token-based Lambda authorizer (also called a TOKEN authorizer) receives the caller's identity in a bearer token, such as a JSON Web Token (JWT) or an OAuth token. For an example application, see Open Banking Brazil - Authorization Samples on GitHub.

    -   A request parameter-based Lambda authorizer (also called a REQUEST authorizer) receives the caller's identity in a combination of headers, query string parameters, stageVariables, and $context variables.

For WebSocket APIs, only request parameter-based authorizers are supported.

!!! important "Using custom authorizer"
    It is possible to use an AWS Lambda function from an AWS account that is different from the one in which you created your API. For more information,


<center> <img src="../images/amardhillon_diagrams-custom lambda auth.drawio.png" width="95%"> </center>


## Authorization workflow

1. The client calls a method on an API Gateway API method, passing a bearer token or request parameters.

!!! question "What is Bearer token?"
    `Bearer authentication` (also called token authentication) is an `HTTP authentication` scheme that involves security tokens called bearer tokens. The name “Bearer authentication” can be understood as “give access to the bearer of this token.” The bearer token is a cryptic string, usually generated by the server in response to a login request. The client must send this token in the Authorization header when making requests to protected resources

1.  `API Gateway` checks whether a `Lambda authorizer` is configured for the method. If it is, API Gateway calls the Lambda function.
1. The Lambda function authenticates the caller by means such as the following:
      1. Calling out to an `OAuth provider` to get an OAuth access token
      2. Calling out to a `SAML provider` to get a SAML assertion.
      3. Generating an `IAM policy` based on the request parameter values.
      4. Retrieving credentials from a database.

2. If the call succeeds, the `Lambda function` grants access by returning an output object containing at least an `IAM policy` and a `principal identifier`.

3. API Gateway evaluates the policy.
      1. If access is denied, API Gateway returns a suitable HTTP status code, such as `403 ACCESS_DENIED`.
      2. If access is allowed, API Gateway executes the method. If caching is enabled in the authorizer settings, API Gateway also caches the policy so that the Lambda authorizer function doesn't need to be invoked again.

